<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HadiTheBadie Platform</title>

<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{
  font-family:'Roboto',sans-serif;
  background:#0d0d0d;color:#f0f0f0;
  overflow:hidden; /* no scroll on home */
}

/* INTRO */
#intro{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:#000;color:#00ffff;
  display:flex;align-items:center;justify-content:center;
  font-family:'Luckiest Guy',cursive;
  font-size:4rem;z-index:2000;opacity:1;
  transition:opacity 1s ease;
}

/* HOME */
#home{
  position:fixed;top:0;left:0;width:100%;height:100vh;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  background:#0d0d0d;z-index:100;
  transition:opacity .8s ease;
}
#home h2{
  color:#00ffff;
  font-size:2rem;
  margin-bottom:30px;
  text-shadow:0 0 15px #00ffff,0 0 30px #00ffff;
  transition:opacity .6s ease;
}
#home button{
  padding:15px 40px;font-size:22px;
  border:2px solid #00ffff;border-radius:12px;
  cursor:pointer;background:transparent;color:#00ffff;
  transition:.3s;margin:10px;
}
#home button:hover{background:#00ffff;color:#000;}

/* SECTIONS */
.section{
  position:fixed;top:0;left:0;width:100%;height:100vh;
  background:#0d0d0d;
  opacity:0;pointer-events:none;
  transition:opacity .8s ease;
}
.section.active{
  opacity:1;pointer-events:auto;
  z-index:150;
}

/* BACK BUTTON */
.back-btn{
  position:fixed;top:20px;left:20px;
  background:#00ffff;color:#000;border:none;
  padding:10px 18px;border-radius:8px;
  font-weight:bold;cursor:pointer;z-index:300;
}
.back-btn:hover{background:#00b3b3;}

/* SHOP */
#shopSection{
  display:flex;flex-direction:column;gap:30px;
  max-height:100vh;overflow-y:auto;padding:20px;
}
.category-title{
  font-size:1.4rem;font-weight:bold;color:#ff9900;margin-left:10px;margin-bottom:10px;
  opacity:0;transform:translateY(-20px);transition:.5s;
}
.category-title.show{opacity:1;transform:translateY(0);}
.product-card{
  background:#1a1a1a;padding:20px;border-radius:12px;
  border-left:4px solid #00ffff;
  opacity:0;transform:translateX(-20px);
  transition:opacity .5s, transform .5s;
  cursor:pointer;margin-left:10px;
}
.product-card.show{opacity:1;transform:translateX(0);}
.product-card h3{color:#00ffff;margin-bottom:8px;}
.product-card p{color:#ccc;font-size:14px;}

/* GAMES */
#gamesSection{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:20px;
}
.game-btns{display:flex;gap:15px;}
.game-btns button{
  padding:10px 20px;background:#00ffff;
  color:#000;border:none;border-radius:8px;
  cursor:pointer;font-size:16px;transition:.3s;
}
.game-btns button:hover{background:#00b3b3;}

/* POPUP */
#popupNote{
  position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:rgba(0,0,0,0.95);
  border:2px solid #00ffff;padding:25px 35px;border-radius:12px;
  color:#00ffff;z-index:4000;
  opacity:0;pointer-events:none;transition:.4s;
}
#popupNote.show{
  opacity:1;pointer-events:auto;
}

/* Scrollbar */
#shopSection::-webkit-scrollbar{width:8px;}
#shopSection::-webkit-scrollbar-thumb{
  background:#00ffff;border-radius:10px;
}
#shopSection::-webkit-scrollbar-thumb:hover{
  background:#00b3b3;
}

/* SCROLLBAR FOR PASTE CONTENT */
#pasteContent::-webkit-scrollbar{width:8px;}
#pasteContent::-webkit-scrollbar-thumb{
  background:#00ffff;border-radius:10px;
}
#pasteContent::-webkit-scrollbar-thumb:hover{
  background:#00b3b3;
}
</style>
</head>
<body>

<!-- INTRO -->
<div id="intro">HadiTheBadie</div>

<!-- HOME -->
<div id="home">
  <h2 id="headline">1600+ Cheap Robux in stock</h2>
  <button onclick="openSection('shop')">Shop</button>
  <button onclick="openSection('games')">Games</button>
  <button onclick="openTerminal()">Terminal</button>
  <button onclick="openSection('paste')">Paste</button>
</div>

<!-- SHOP -->
<div id="shopSection" class="section">
  <button class="back-btn" onclick="goHome()">‚Üê Home</button>

  <div class="category-title">Robux</div>
  <div class="product-card"><h3>Robux 200-250</h3><p>Price: ¬£3</p></div>

  <div class="category-title">Brainrots</div>
  <div class="product-card"><h3>Los Combination</h3><p>Price: ¬£9</p></div>
  <div class="product-card"><h3>La Grande Combination</h3><p>Price: ¬£7</p></div>
  <div class="product-card"><h3>Brainrots 100m‚Äì500m Available</h3><p>Price:</p></div>

  <div class="category-title">Fun</div>
  <div class="product-card"><h3>Pen Watergun</h3><p>Pen that can shoot water with pressure</p><p>Price: ¬£3.99</p></div>

  <div class="category-title">Website</div>
  <div class="product-card"><h3>Your Website</h3><p>Your own customized website</p><p>Price: ¬£20</p></div>

  <div class="category-title">Roblox Game</div>
  <div class="product-card"><h3>Your Roblox Game</h3><p>Fully customized</p><p>Price: ¬£10</p></div>

  <div class="category-title">Others</div>
  <div class="product-card"><h3>99 Nights in Forest</h3><p>Price: ¬£2.99</p></div>
  <div class="product-card"><h3>Steal a Brainrot</h3><p>Sab Private Server</p><p>Price: ¬£1.20/month</p></div>
  <div class="product-card"><h3>Grow a Garden Pets</h3><p>Price: ¬£2</p></div>
</div>

<!-- GAMES -->
<div id="gamesSection" class="section">
  <button class="back-btn" onclick="goHome()">‚Üê Home</button>
  <div class="game-btns">
    <button onclick="redirectGame('minecraft')">Minecraft</button>
    <button onclick="redirectGame('1v1')">1v1.lol</button>
  </div>
</div>

<!-- PASTE SECTION WITH SCROLL -->
<div id="pasteSection" class="section">
  <button class="back-btn" onclick="goHome()">‚Üê Home</button>

  <div style="padding:40px; text-align:center;">
    <h2 style="color:#00ffff; margin-bottom:20px;">Paste Your Text Below</h2>

    <div id="pasteContent" 
         style="background:#1a1a1a; padding:25px; border-radius:12px; border-left:4px solid #00ffff;
         max-height:60vh; overflow-y:auto; overflow-x:hidden;">
      <p style="color:#ccc;"># ================================================================
# PART 1 ‚Äî IMPORTS, DATABASE, GLOBALS
# ================================================================
 
import os
import sqlite3
import threading
import time
import socket
import tkinter as tk
from tkinter import messagebox, filedialog
import webbrowser
import requests
from PIL import Image, ImageTk
from flask import Flask, request, jsonify, send_from_directory
from flask_socketio import SocketIO, emit
from werkzeug.utils import secure_filename
from socketio import Client as SocketIOClient
 
# -----------------------------
# GLOBAL UI COLORS
# -----------------------------
BG = "#111111"
BTN = "#222222"
BTN_HOVER = "#2b4cff"
TXT = "white"
 
CURRENT_USER = None
 
# -----------------------------
# DATABASE INIT
# -----------------------------
DB = sqlite3.connect("m3n_data.db", check_same_thread=False)
cur = DB.cursor()
 
cur.execute("""
CREATE TABLE IF NOT EXISTS users(
    username TEXT PRIMARY KEY,
    password TEXT,
    pfp TEXT
)
""")
 
cur.execute("""
CREATE TABLE IF NOT EXISTS chat(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT,
    message TEXT,
    timestamp TEXT
)
""")
 
cur.execute("""
CREATE TABLE IF NOT EXISTS feed(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    filename TEXT,
    uploader TEXT
)
""")
 
cur.execute("""
CREATE TABLE IF NOT EXISTS likes(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    media_id INTEGER,
    username TEXT
)
""")
 
cur.execute("""
CREATE TABLE IF NOT EXISTS comments(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    media_id INTEGER,
    username TEXT,
    text TEXT
)
""")
 
DB.commit()
 
os.makedirs("feed", exist_ok=True)
os.makedirs("pfp", exist_ok=True)
 
 
# -----------------------------
# Button creator
# -----------------------------
def make_button(parent, text, cmd, w=22):
    btn = tk.Button(
        parent,
        text=text,
        width=w,
        height=2,
        bg=BTN,
        fg=TXT,
        font=("Segoe UI", 12),
        command=cmd,
        activebackground=BTN_HOVER,
        activeforeground="white"
    )
 
    def hover_in(e): btn.config(bg=BTN_HOVER)
    def hover_out(e): btn.config(bg=BTN)
 
    btn.bind("<Enter>", hover_in)
    btn.bind("<Leave>", hover_out)
    btn.pack(pady=6)
    return btn
# ================================================================
# PART 2 ‚Äî FLASK FEED SERVER + SOCKET.IO REAL-TIME CHAT
# ================================================================
 
flask_app = Flask(__name__)
flask_app.config['SECRET_KEY'] = "m3n_secret"
socketio = SocketIO(flask_app, cors_allowed_origins="*")
 
UPLOAD_FOLDER = "feed"
flask_app.config["UPLOAD_FOLDER"] = UPLOAD_FOLDER
 
 
# ================================================================
# REAL-TIME CHAT (SOCKET.IO)
# ================================================================
@socketio.on("send_message")
def handle_send_message(data):
    username = data.get("username", "Unknown")
    text = data.get("text", "")
 
    if not text.strip():
        return
 
    # Save to DB
    cur.execute(
        "INSERT INTO chat(username, message, timestamp) VALUES(?,?,datetime('now'))",
        (username, text)
    )
    DB.commit()
 
    # Broadcast
    emit("new_message", {"username": username, "text": text}, broadcast=True)
 
 
# Chat history endpoint (for Tkinter chat window)
@flask_app.route("/chat_history")
def chat_history():
    cur.execute("SELECT username, message FROM chat ORDER BY id ASC")
    rows = cur.fetchall()
    return jsonify(rows)
 
 
# ================================================================
# FEED HTML PAGE
# ================================================================
@flask_app.route("/feed")
def feed_page():
    html = """
    <html>
    <head>
        <title>M3N Feed</title>
        <style>
            body { background:#111; color:white; font-family:Segoe UI; }
            h1 { text-align:center; margin-top:30px; }
            .item {
                background:#222;
                padding:15px;
                margin:20px auto;
                width:80%;
                border-radius:10px;
            }
            img, video { max-width:100%; border-radius:8px; }
            .meta { margin-top:10px; font-size:14px; }
        </style>
    </head>
    <body>
        <h1>M3N Feed ‚Äî Made by Hadi ‚ù§Ô∏è</h1>
    """
 
    cur.execute("SELECT id, filename, uploader FROM feed ORDER BY id DESC")
    files = cur.fetchall()
 
    for media_id, filename, uploader in files:
        html += "<div class='item'>"
        html += f"<h3>{filename} ‚Äî by {uploader}</h3>"
 
        ext = filename.lower().split(".")[-1]
        url = "/media/" + filename
 
        if ext in ("png", "jpg", "jpeg"):
            html += f"<img src='{url}' />"
        else:
            html += f"<video controls src='{url}'></video>"
 
        # Likes
        cur.execute("SELECT COUNT(*) FROM likes WHERE media_id=?", (media_id,))
        likes = cur.fetchone()[0]
 
        # Comments count
        cur.execute("SELECT COUNT(*) FROM comments WHERE media_id=?", (media_id,))
        cc = cur.fetchone()[0]
 
        html += f"<div class='meta'>‚ù§Ô∏è Likes: {likes} ‚Äî üí¨ Comments: {cc}</div>"
        html += "</div>"
 
    html += "</body></html>"
    return html
 
 
# ================================================================
# SERVE MEDIA FILES
# ================================================================
@flask_app.route("/media/<path:filename>")
def serve_media(filename):
    return send_from_directory(UPLOAD_FOLDER, filename)
 
 
# ================================================================
# UPLOAD MEDIA
# ================================================================
@flask_app.route("/upload_media", methods=["POST"])
def upload_media():
    file = request.files.get("file")
    username = request.form.get("username")
 
    if not file:
        return "No file uploaded.", 400
 
    fname = secure_filename(file.filename)
    save_path = os.path.join(UPLOAD_FOLDER, fname)
    file.save(save_path)
 
    cur.execute("INSERT INTO feed(filename, uploader) VALUES(?,?)", (fname, username))
    DB.commit()
 
    return "OK"
 
 
# ================================================================
# LIKE MEDIA
# ================================================================
@flask_app.route("/like", methods=["POST"])
def like_media():
    mid = request.form.get("media_id")
    username = request.form.get("username")
 
    if mid and username:
        cur.execute("INSERT INTO likes(media_id, username) VALUES(?,?)", (mid, username))
        DB.commit()
 
    return "OK"
 
 
# ================================================================
# COMMENT MEDIA
# ================================================================
@flask_app.route("/comment", methods=["POST"])
def comment_media():
    mid = request.form.get("media_id")
    username = request.form.get("username")
    text = request.form.get("text")
 
    if mid and username and text:
        cur.execute(
            "INSERT INTO comments(media_id, username, text) VALUES(?,?,?)",
            (mid, username, text)
        )
        DB.commit()
 
    return "OK"
 
 
# ================================================================
# START SERVER THREAD
# ================================================================
def start_flask_server():
    socketio.run(flask_app, host="0.0.0.0", port=5000, debug=False)
# ================================================================
# PART 3 ‚Äî SIMPLE LOGIN + REGISTER (ONE WINDOW)
# ================================================================
 
def open_login():
    global CURRENT_USER
 
    root = tk.Tk()
    root.title("M3N Login")
    root.geometry("480x380")
    root.configure(bg=BG)
 
    tk.Label(
        root,
        text="M3N Login",
        fg="white",
        bg=BG,
        font=("Segoe UI", 28, "bold")
    ).pack(pady=25)
 
    frame = tk.Frame(root, bg=BG)
    frame.pack()
 
    # -------------------------------
    # Username Entry
    # -------------------------------
    tk.Label(frame, text="Username:", fg="white", bg=BG,
             font=("Segoe UI", 14)).pack(pady=5)
    username_entry = tk.Entry(frame, font=("Segoe UI", 14))
    username_entry.pack()
 
    # -------------------------------
    # Password Entry
    # -------------------------------
    tk.Label(frame, text="Password:", fg="white", bg=BG,
             font=("Segoe UI", 14)).pack(pady=5)
    password_entry = tk.Entry(frame, font=("Segoe UI", 14), show="*")
    password_entry.pack()
 
    # ============================================================
    # LOGIN FUNCTION
    # ============================================================
    def do_login():
        global CURRENT_USER
 
        u = username_entry.get().strip()
        p = password_entry.get().strip()
 
        if not u or not p:
            messagebox.showerror("Error", "Please fill all fields.")
            return
 
        cur.execute("SELECT password FROM users WHERE username=?", (u,))
        row = cur.fetchone()
 
        if not row:
            messagebox.showerror("Error", "User does not exist.")
            return
 
        if row[0] != p:
            messagebox.showerror("Error", "Incorrect password.")
            return
 
        CURRENT_USER = u
        root.destroy()
        open_dashboard()
 
    # ============================================================
    # REGISTER FUNCTION
    # ============================================================
    def do_register():
        u = username_entry.get().strip()
        p = password_entry.get().strip()
 
        if not u or not p:
            messagebox.showerror("Error", "Enter username + password first.")
            return
 
        cur.execute("SELECT username FROM users WHERE username=?", (u,))
        if cur.fetchone():
            messagebox.showerror("Error", "Username already taken.")
            return
 
        cur.execute(
            "INSERT INTO users(username, password, pfp) VALUES(?,?,?)",
            (u, p, "")
        )
        DB.commit()
 
        messagebox.showinfo("Success", "Account created! You may login now.")
 
    # -------------------------------
    # Buttons
    # -------------------------------
    make_button(frame, "Login", do_login)
    make_button(frame, "Register", do_register)
 
    tk.Label(
        root,
        text="Made by Hadi ‚ù§Ô∏è",
        fg="#4da6ff",
        bg=BG,
        font=("Segoe UI", 12)
    ).pack(pady=20)
 
    root.mainloop()
# ================================================================
# PART 4 ‚Äî DASHBOARD (ALL BUTTONS, 2-COLUMN LAYOUT)
# ================================================================
 
def open_dashboard():
    dash = tk.Tk()
    dash.title("M3N Dashboard")
    dash.geometry("950x550")
    dash.configure(bg=BG)
    dash.resizable(True, True)
 
    # Title
    tk.Label(
        dash,
        text=f"Welcome, {CURRENT_USER}",
        fg="white",
        bg=BG,
        font=("Segoe UI", 28, "bold")
    ).pack(pady=25)
 
    # Container for columns
    container = tk.Frame(dash, bg=BG)
    container.pack()
 
    left = tk.Frame(container, bg=BG)
    right = tk.Frame(container, bg=BG)
    left.grid(row=0, column=0, padx=80)
    right.grid(row=0, column=1, padx=80)
 
    # -----------------------------------------------------------
    # FEED OPENER (FORCE MICROSOFT EDGE)
    # -----------------------------------------------------------
    def open_feed_edge():
        try:
            webbrowser.get("windows-edge").open_new("http://127.0.0.1:5000/feed")
        except:
            paths = [
                r"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe",
                r"C:\Program Files\Microsoft\Edge\Application\msedge.exe",
            ]
            for p in paths:
                if os.path.exists(p):
                    os.system(f'"{p}" http://127.0.0.1:5000/feed')
                    return
            webbrowser.open("http://127.0.0.1:5000/feed")
 
    # -----------------------------------------------------------
    # LEFT COLUMN BUTTONS
    # -----------------------------------------------------------
    make_button(left, "Global Chat", open_chat_window)
    make_button(left, "Open Feed (Edge)", open_feed_edge)
    make_button(left, "Upload Media", open_upload_window)
    make_button(left, "Snake Game", open_snake_game)
 
    # -----------------------------------------------------------
    # RIGHT COLUMN BUTTONS
    # -----------------------------------------------------------
 
    make_button(right, "Change Profile Picture", open_pfp_window)
 
    make_button(right, "Minecraft Website",
                lambda: webbrowser.open("https://example.com"))
 
    make_button(right, "Credits (Made by Hadi)",
                lambda: messagebox.showinfo("Credits", "Made by Hadi ‚ù§Ô∏è"))
 
    def logout():
        dash.destroy()
        open_login()
 
    make_button(right, "Logout", logout)
    make_button(right, "Exit Application", dash.destroy)
# ================================================================
# PART 5 ‚Äî REAL-TIME TKINTER CHAT WITH SCROLLBAR (CLASSIC FORMAT)
# ================================================================
 
sio = SocketIOClient()
 
# ------------------------------------------------------------
# Connect client to Socket.IO server
# ------------------------------------------------------------
def start_socket_client():
    try:
        sio.connect("http://127.0.0.1:5000")
        print("[CHAT] Connected to server")
    except Exception as e:
        print("[CHAT ERROR]", e)
 
threading.Thread(target=start_socket_client, daemon=True).start()
 
 
# ============================================================
# OPEN CHAT WINDOW
# ============================================================
def open_chat_window():
    chat = tk.Toplevel()
    chat.title("Global Chat")
    chat.geometry("700x600")
    chat.configure(bg=BG)
    chat.resizable(True, True)
 
    tk.Label(
        chat,
        text="Global Chat",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=10)
 
    # --------------------------------------------------------
    # SCROLLABLE CHAT LOG
    # --------------------------------------------------------
    log_frame = tk.Frame(chat, bg=BG)
    log_frame.pack(fill="both", expand=True, padx=10, pady=10)
 
    scrollbar = tk.Scrollbar(log_frame)
    scrollbar.pack(side="right", fill="y")
 
    log = tk.Text(
        log_frame,
        bg="#000000",
        fg="white",
        font=("Segoe UI", 12),
        state="disabled",
        wrap="word",
        yscrollcommand=scrollbar.set
    )
    log.pack(side="left", fill="both", expand=True)
    scrollbar.config(command=log.yview)
 
    # --------------------------------------------------------
    # MESSAGE ENTRY
    # --------------------------------------------------------
    bottom = tk.Frame(chat, bg=BG)
    bottom.pack(fill="x")
 
    entry = tk.Entry(
        bottom,
        bg="#222222",
        fg="white",
        font=("Segoe UI", 14),
        insertbackground="white",
        relief="flat"
    )
    entry.pack(side="left", fill="x", expand=True, padx=10, pady=10)
 
    # --------------------------------------------------------
    # SEND MESSAGE
    # --------------------------------------------------------
    def send_message(event=None):
        text = entry.get().rstrip()
        if not text:
            return
 
        sio.emit("send_message", {
            "username": CURRENT_USER,
            "text": text
        })
 
        entry.delete(0, tk.END)
 
    entry.bind("<Return>", send_message)
 
    tk.Button(
        bottom,
        text="Send",
        bg=BTN,
        fg="white",
        activebackground=BTN_HOVER,
        activeforeground="white",
        width=12,
        command=send_message
    ).pack(side="left", padx=10)
 
    # --------------------------------------------------------
    # LOAD CHAT HISTORY
    # --------------------------------------------------------
    try:
        history = requests.get("http://127.0.0.1:5000/chat_history").json()
 
        log.config(state="normal")
        for username, msg in history:
            log.insert(tk.END, f"{username}: {msg}\n")
        log.config(state="disabled")
        log.see(tk.END)
    except:
        print("[CHAT] Could not load chat history")
 
    # --------------------------------------------------------
    # RECEIVE REAL-TIME MESSAGES
    # --------------------------------------------------------
    @sio.on("new_message")
    def receive_message(data):
        log.config(state="normal")
        # CLASSIC FORMAT ‚Üí single line
        log.insert(tk.END, f"{data['username']}: {data['text']}\n")
        log.config(state="disabled")
        log.see(tk.END)
 
    chat.mainloop()
 
 
# ================================================================
# PART 6 ‚Äî UPLOAD MEDIA WINDOW
# ================================================================
 
def open_upload_window():
    win = tk.Toplevel()
    win.title("Upload Media")
    win.geometry("450x280")
    win.configure(bg=BG)
    win.resizable(False, False)
 
    tk.Label(
        win,
        text="Upload Image / Video",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=15)
 
    # Selected file path
    selected_path = tk.StringVar(value="No file selected")
 
    tk.Label(
        win,
        textvariable=selected_path,
        fg="#bbbbbb",
        bg=BG,
        font=("Segoe UI", 10)
    ).pack(pady=4)
 
    # -------------------------------
    # FILE PICKER
    # -------------------------------
    def choose_file():
        fp = filedialog.askopenfilename(
            title="Select media",
            filetypes=[
                ("Media Files", "*.png *.jpg *.jpeg *.mp4 *.mov *.webm"),
                ("All Files", "*.*")
            ]
        )
        if fp:
            selected_path.set(fp)
 
    make_button(win, "Choose File", choose_file, w=18)
 
    # -------------------------------
    # UPLOAD FUNCTION
    # -------------------------------
    def upload_now():
        fp = selected_path.get()
        if fp == "No file selected":
            messagebox.showerror("Error", "Choose a media file first.")
            return
 
        try:
            files = {"file": open(fp, "rb")}
            data = {"username": CURRENT_USER}
 
            r = requests.post("http://127.0.0.1:5000/upload_media", files=files, data=data)
 
            if r.status_code == 200:
                messagebox.showinfo("Success", "Upload complete! Check the Feed.")
            else:
                messagebox.showerror("Error", f"Upload failed: {r.text}")
 
        except Exception as e:
            messagebox.showerror("Error", f"Upload error:\n{e}")
 
    make_button(win, "Upload", upload_now, w=18)
# ================================================================
# PART 7 ‚Äî SETTINGS WINDOW + PROFILE PICTURE WINDOW
# ================================================================
 
# -----------------------------
# SETTINGS WINDOW
# -----------------------------
def open_settings_window():
    win = tk.Toplevel()
    win.title("Settings")
    win.geometry("450x420")
    win.configure(bg=BG)
    win.resizable(False, False)
 
    tk.Label(
        win,
        text="Settings",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=15)
 
    # -------------------------
    # CLEAR CHAT HISTORY
    # -------------------------
    def clear_chat():
        if messagebox.askyesno("Confirm", "Delete ALL chat messages?"):
            cur.execute("DELETE FROM chat")
            DB.commit()
            messagebox.showinfo("Done", "Chat history cleared.")
 
    make_button(win, "Clear Chat History", clear_chat, w=25)
 
    # -------------------------
    # CLEAR FEED
    # -------------------------
    def clear_feed():
        if messagebox.askyesno("Confirm", "Delete ALL media in Feed?"):
            cur.execute("DELETE FROM feed")
            cur.execute("DELETE FROM likes")
            cur.execute("DELETE FROM comments")
            DB.commit()
 
            # Remove files
            for f in os.listdir("feed"):
                fp = os.path.join("feed", f)
                try:
                    os.remove(fp)
                except:
                    pass
 
            messagebox.showinfo("Done", "Feed cleared.")
 
    make_button(win, "Clear Image/Video Feed", clear_feed, w=25)
 
    # -------------------------
    # CLEAR ALL LIKES & COMMENTS
    # -------------------------
    def clear_reactions():
        cur.execute("DELETE FROM likes")
        cur.execute("DELETE FROM comments")
        DB.commit()
        messagebox.showinfo("Done", "All likes and comments removed.")
 
    make_button(win, "Clear Likes + Comments", clear_reactions, w=25)
 
    # -------------------------
    # RESET EVERYTHING
    # -------------------------
    def full_reset():
        if not messagebox.askyesno("Confirm", "Delete ALL DATA (users, chat, feed)?"):
            return
 
        cur.execute("DELETE FROM users")
        cur.execute("DELETE FROM chat")
        cur.execute("DELETE FROM feed")
        cur.execute("DELETE FROM likes")
        cur.execute("DELETE FROM comments")
        DB.commit()
 
        for folder in ["feed", "pfp"]:
            for f in os.listdir(folder):
                try:
                    os.remove(os.path.join(folder, f))
                except:
                    pass
 
        messagebox.showinfo("Done", "All data reset. Restart app.")
 
    make_button(win, "FULL RESET (All Data)", full_reset, w=25)
 
 
# -----------------------------
# PROFILE PICTURE WINDOW
# -----------------------------
def open_pfp_window():
    win = tk.Toplevel()
    win.title("Change Profile Picture")
    win.geometry("420x300")
    win.configure(bg=BG)
    win.resizable(False, False)
 
    tk.Label(
        win,
        text="Change Profile Picture",
        fg="white",
        bg=BG,
        font=("Segoe UI", 20, "bold")
    ).pack(pady=15)
 
    selected_path = tk.StringVar(value="No file selected")
 
    tk.Label(
        win,
        textvariable=selected_path,
        fg="#bbbbbb",
        bg=BG,
        font=("Segoe UI", 10)
    ).pack(pady=5)
 
 
    # -------------------------
    # PICK FILE
    # -------------------------
    def pick_image():
        fp = filedialog.askopenfilename(
            title="Choose Profile Picture",
            filetypes=[
                ("Image Files", "*.png *.jpg *.jpeg"),
                ("All Files", "*.*")
            ]
        )
        if fp:
            selected_path.set(fp)
 
    make_button(win, "Choose Image", pick_image, w=20)
 
 
    # -------------------------
    # SAVE PFP
    # -------------------------
    def save_pfp():
        path = selected_path.get()
        if path == "No file selected":
            messagebox.showerror("Error", "Choose an image first.")
            return
 
        try:
            # Save PFP as USERNAME.png
            new_path = f"pfp/{CURRENT_USER}.png"
            img = Image.open(path)
            img = img.resize((128, 128))
            img.save(new_path)
 
            cur.execute("UPDATE users SET pfp=? WHERE username=?",
                        (new_path, CURRENT_USER))
            DB.commit()
 
            messagebox.showinfo("Success", "Profile picture updated!")
 
        except Exception as e:
            messagebox.showerror("Error", f"Could not save PFP:\n{e}")
 
    make_button(win, "Save Profile Picture", save_pfp, w=20)
 
# ================================================================
# PART 8 ‚Äî SNAKE GAME WINDOW
# ================================================================
 
def open_snake_game():
    game = tk.Toplevel()
    game.title("Snake Game")
    game.geometry("520x560")
    game.configure(bg=BG)
    game.resizable(False, False)
 
    W, H = 500, 500
    SIZE = 20
 
    tk.Label(
        game,
        text="Snake Game",
        fg="white",
        bg=BG,
        font=("Segoe UI", 20, "bold")
    ).pack(pady=5)
 
    canvas = tk.Canvas(game, width=W, height=H, bg="black")
    canvas.pack()
 
    # Snake starting position
    snake = [(100, 100), (80, 100), (60, 100)]
    direction = "RIGHT"
 
    import random
 
    def spawn_food():
        return (random.randint(0, (W//SIZE)-1) * SIZE,
                random.randint(0, (H//SIZE)-1) * SIZE)
 
    food = spawn_food()
    score = 0
 
    # -------------------------------------------------------
    # Draw everything
    # -------------------------------------------------------
    def draw():
        canvas.delete("all")
 
        # Draw snake
        for x, y in snake:
            canvas.create_rectangle(x, y, x+SIZE, y+SIZE, fill="green")
 
        # Draw food
        fx, fy = food
        canvas.create_oval(fx, fy, fx+SIZE, fy+SIZE, fill="red")
 
        # Score
        canvas.create_text(10, 10, anchor="nw", fill="white",
                           font=("Segoe UI", 14),
                           text=f"Score: {score}")
 
    # -------------------------------------------------------
    # Game loop
    # -------------------------------------------------------
    def move():
        nonlocal food, score, direction
 
        x, y = snake[0]
 
        if direction == "UP":    y -= SIZE
        if direction == "DOWN":  y += SIZE
        if direction == "LEFT":  x -= SIZE
        if direction == "RIGHT": x += SIZE
 
        new_head = (x, y)
 
        # Wall collision
        if x < 0 or x >= W or y < 0 or y >= H:
            messagebox.showinfo("Game Over", f"Final Score: {score}")
            game.destroy()
            return
 
        # Self collision
        if new_head in snake:
            messagebox.showinfo("Game Over", f"Final Score: {score}")
            game.destroy()
            return
 
        snake.insert(0, new_head)
 
        # Food eaten
        if new_head == food:
            score += 1
            food = spawn_food()
        else:
            snake.pop()
 
        draw()
        game.after(100, move)
 
    # -------------------------------------------------------
    # Keyboard controls
    # -------------------------------------------------------
    def key(event):
        nonlocal direction
 
        k = event.keysym.upper()
 
        if k in ("W", "UP") and direction != "DOWN":
            direction = "UP"
        elif k in ("S", "DOWN") and direction != "UP":
            direction = "DOWN"
        elif k in ("A", "LEFT") and direction != "RIGHT":
            direction = "LEFT"
        elif k in ("D", "RIGHT") and direction != "LEFT":
            direction = "RIGHT"
 
    game.bind("<Key>", key)
 
    draw()
    move()
# ================================================================
# PART 9 ‚Äî FINAL STARTUP (START SERVER + OPEN LOGIN)
# ================================================================
 
def start_servers():
    # Run Flask + Socket.IO in background
    t = threading.Thread(target=start_flask_server, daemon=True)
    t.start()
    time.sleep(1.5)  # give server time to start
 
 
if __name__ == "__main__":
    start_servers()
    open_login()  # start GUI</p>
    </div>
  </div>
</div>

<!-- POPUP -->
<div id="popupNote">If you want to buy this product, contact us on Discord: Mazm3n</div>

<script>
// INTRO
window.addEventListener("DOMContentLoaded",()=>{
  const intro=document.getElementById("intro");

  setTimeout(()=>{
    intro.style.opacity="0";
    setTimeout(()=>intro.style.display="none",1000);
    setTimeout(()=>startHeadline(),1100);
  },3000);
});

// HEADLINE & COUNT
function startHeadline(){
  const headline=document.getElementById("headline");

  const texts=[
    "1600+ Cheap Robux in stock",
    "Wanna buy? Contact us in Discord/Snapchat",
    "100% Trusted Market",
    "Make sure to feed back to help us improve"
  ];

  let index=0;

  function countUp(){
    let num=0;
    const target=1600;
    const duration=3000;
    const steps=60;
    const inc=target/steps;

    const interval=setInterval(()=>{
      num+=inc;
      if(num>=1600){
        num=1600;
        clearInterval(interval);
      }
      headline.textContent=Math.floor(num) + "+ Cheap Robux in stock";
    },duration/steps);
  }

  countUp();

  setInterval(()=>{
    headline.style.opacity="0";

    setTimeout(()=>{
      index=(index+1)%texts.length;
      headline.textContent=texts[index];
      if(index===0) countUp();
      headline.style.opacity="1";
    },600);

  },5000);
}

// SECTION OPEN
function openSection(section){
  document.body.style.overflow="hidden";

  const home=document.getElementById("home");
  home.style.opacity="0";
  home.style.pointerEvents="none";

  const sec=document.getElementById(section+"Section");
  setTimeout(()=>{
    sec.classList.add("active");
    if(section==='shop') animateShop();
  },400);
}

// TERMINAL OPEN
function openTerminal(){
  window.location.href="Terminal.html";
}

// BACK HOME
function goHome(){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));

  const home=document.getElementById("home");
  home.style.opacity="1";
  home.style.pointerEvents="auto";
}

// SHOP ANIMATION
function animateShop(){
  const shop=document.getElementById('shopSection');
  const cats=shop.querySelectorAll('.category-title');
  const cards=shop.querySelectorAll('.product-card');

  cats.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*200));
  cards.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*200+300));

  cards.forEach(card=>card.onclick=()=>showPopup());
}

// POPUP
function showPopup(){
  const popup=document.getElementById('popupNote');
  popup.classList.add('show');
  setTimeout(()=>popup.classList.remove('show'),4000);
}

// GAME REDIRECTS
function redirectGame(game){
  if(game==='minecraft') window.location.href="https://avacaine.github.io/";
  if(game==='1v1') window.location.href="https://funblocked.s3.amazonaws.com/1v1.html";
}
</script>
</body>
</html>



<script type="text/javascript">window.$crisp=[];window.CRISP_WEBSITE_ID="49cbe588-16a0-40ad-b50b-844419c11121";(function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();</script>
