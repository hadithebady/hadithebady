<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HadiTheBadie Platform</title>

<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{
  font-family:'Roboto',sans-serif;
  background:#0d0d0d;color:#f0f0f0;
  overflow:hidden; /* no scroll on home */
}

/* INTRO */
#intro{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:#000;color:#00ffff;
  display:flex;align-items:center;justify-content:center;
  font-family:'Luckiest Guy',cursive;
  font-size:4rem;z-index:2000;opacity:1;
  transition:opacity 1s ease;
}

/* HOME */
#home{
  position:fixed;top:0;left:0;width:100%;height:100vh;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  background:#0d0d0d;z-index:100;
  transition:opacity .8s ease;
}
#home h2{
  color:#00ffff;
  font-size:2rem;
  margin-bottom:30px;
  text-shadow:0 0 15px #00ffff,0 0 30px #00ffff;
  transition:opacity .6s ease;
}
#home button{
  padding:15px 40px;font-size:22px;
  border:2px solid #00ffff;border-radius:12px;
  cursor:pointer;background:transparent;color:#00ffff;
  transition:.3s;margin:10px;
}
#home button:hover{background:#00ffff;color:#000;}

/* SECTIONS */
.section{
  position:fixed;top:0;left:0;width:100%;height:100vh;
  background:#0d0d0d;
  opacity:0;pointer-events:none;
  transition:opacity .8s ease;
}
.section.active{
  opacity:1;pointer-events:auto;
  z-index:150;
}

/* BACK BUTTON */
.back-btn{
  position:fixed;top:20px;left:20px;
  background:#00ffff;color:#000;border:none;
  padding:10px 18px;border-radius:8px;
  font-weight:bold;cursor:pointer;z-index:300;
}
.back-btn:hover{background:#00b3b3;}

/* SHOP */
#shopSection{
  display:flex;flex-direction:column;gap:30px;
  max-height:100vh;overflow-y:auto;padding:20px;
}
.category-title{
  font-size:1.4rem;font-weight:bold;color:#ff9900;margin-left:10px;margin-bottom:10px;
  opacity:0;transform:translateY(-20px);transition:.5s;
}
.category-title.show{opacity:1;transform:translateY(0);}
.product-card{
  background:#1a1a1a;padding:20px;border-radius:12px;
  border-left:4px solid #00ffff;
  opacity:0;transform:translateX(-20px);
  transition:opacity .5s, transform .5s;
  cursor:pointer;margin-left:10px;
}
.product-card.show{opacity:1;transform:translateX(0);}
.product-card h3{color:#00ffff;margin-bottom:8px;}
.product-card p{color:#ccc;font-size:14px;}

/* GAMES */
#gamesSection{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:20px;
}
.game-btns{display:flex;gap:15px;}
.game-btns button{
  padding:10px 20px;background:#00ffff;
  color:#000;border:none;border-radius:8px;
  cursor:pointer;font-size:16px;transition:.3s;
}
.game-btns button:hover{background:#00b3b3;}

/* POPUP */
#popupNote{
  position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:rgba(0,0,0,0.95);
  border:2px solid #00ffff;padding:25px 35px;border-radius:12px;
  color:#00ffff;z-index:4000;
  opacity:0;pointer-events:none;transition:.4s;
}
#popupNote.show{
  opacity:1;pointer-events:auto;
}

/* Scrollbar */
#shopSection::-webkit-scrollbar{width:8px;}
#shopSection::-webkit-scrollbar-thumb{
  background:#00ffff;border-radius:10px;
}
#shopSection::-webkit-scrollbar-thumb:hover{
  background:#00b3b3;
}

/* SCROLLBAR FOR PASTE CONTENT */
#pasteContent::-webkit-scrollbar{width:8px;}
#pasteContent::-webkit-scrollbar-thumb{
  background:#00ffff;border-radius:10px;
}
#pasteContent::-webkit-scrollbar-thumb:hover{
  background:#00b3b3;
}
</style>
</head>
<body>

<!-- INTRO -->
<div id="intro">HadiTheBadie</div>

<!-- HOME -->
<div id="home">
  <h2 id="headline">1600+ Cheap Robux in stock</h2>
  <button onclick="openSection('shop')">Shop</button>
  <button onclick="openSection('games')">Games</button>
  <button onclick="openTerminal()">Terminal</button>
  <button onclick="openSection('paste')">Paste</button>
</div>

<!-- SHOP -->
<div id="shopSection" class="section">
  <button class="back-btn" onclick="goHome()">← Home</button>

  <div class="category-title">Robux</div>
  <div class="product-card"><h3>Robux 200-250</h3><p>Price: £3</p></div>

  <div class="category-title">Brainrots</div>
  <div class="product-card"><h3>Los Combination</h3><p>Price: £9</p></div>
  <div class="product-card"><h3>La Grande Combination</h3><p>Price: £7</p></div>
  <div class="product-card"><h3>Brainrots 100m–500m Available</h3><p>Price:</p></div>

  <div class="category-title">Fun</div>
  <div class="product-card"><h3>Pen Watergun</h3><p>Pen that can shoot water with pressure</p><p>Price: £3.99</p></div>

  <div class="category-title">Website</div>
  <div class="product-card"><h3>Your Website</h3><p>Your own customized website</p><p>Price: £20</p></div>

  <div class="category-title">Roblox Game</div>
  <div class="product-card"><h3>Your Roblox Game</h3><p>Fully customized</p><p>Price: £10</p></div>

  <div class="category-title">Others</div>
  <div class="product-card"><h3>99 Nights in Forest</h3><p>Price: £2.99</p></div>
  <div class="product-card"><h3>Steal a Brainrot</h3><p>Sab Private Server</p><p>Price: £1.20/month</p></div>
  <div class="product-card"><h3>Grow a Garden Pets</h3><p>Price: £2</p></div>
</div>

<!-- GAMES -->
<div id="gamesSection" class="section">
  <button class="back-btn" onclick="goHome()">← Home</button>
  <div class="game-btns">
    <button onclick="redirectGame('minecraft')">Minecraft</button>
    <button onclick="redirectGame('1v1')">1v1.lol</button>
  </div>
</div>

<!-- PASTE SECTION WITH SCROLL -->
<div id="pasteSection" class="section">
  <button class="back-btn" onclick="goHome()">← Home</button>

  <div style="padding:40px; text-align:center;">
    <h2 style="color:#00ffff; margin-bottom:20px;">Paste Your Text Below</h2>

    <div id="pasteContent" 
         style="background:#1a1a1a; padding:25px; border-radius:12px; border-left:4px solid #00ffff;
         max-height:60vh; overflow-y:auto; overflow-x:hidden;">
      <p style="color:#ccc;"># ================================================================
# PART A — IMPORTS, GLOBALS, SIMPLE STORAGE (FIXED)
# ================================================================

import socket
import pickle
import tkinter as tk
from tkinter import filedialog, messagebox
import os
from PIL import Image, ImageTk

# ----------------------------
# Basic UI colors
# ----------------------------
BG = "#111111"
TXT = "white"
BTN = "#222222"
BTN_HOVER = "#4444aa"

# ----------------------------
# In-memory chat history
# ----------------------------
chat_history = []

# ----------------------------
# Data folders
# ----------------------------
os.makedirs("feed", exist_ok=True)
os.makedirs("pfp", exist_ok=True)

# ----------------------------
# USER DATABASE FIX (IMPORTANT)
# ----------------------------
USER_DB_FILE = "users.pkl"

# Try loading saved users
try:
    with open(USER_DB_FILE, "rb") as f:
        user_db = pickle.load(f)

        # If corrupted, replace
        if not isinstance(user_db, dict):
            user_db = {}
except:
    user_db = {}  # Start fresh if file missing or unreadable

def save_users():
    with open(USER_DB_FILE, "wb") as f:
        pickle.dump(user_db, f)


# ----------------------------
# Networking (LAN)
# ----------------------------
PORT = 5050

def get_local_ip():
    """Returns LAN WiFi IP."""
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    try:
        s.connect(("8.8.8.8", 80))
        ip = s.getsockname()[0]
    except:
        ip = "127.0.0.1"
    finally:
        s.close()
    return ip

LOCAL_IP = get_local_ip()

IS_SERVER = False
server_socket = None
client_socket = None
clients = []  # connected clients (server only)

# ================================================================
# PART B — NON-BLOCKING LAN SERVER (NO THREADS)
# ================================================================

def start_server():
    """Start server if no one else is using the port."""
    global server_socket, IS_SERVER

    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_socket.setblocking(False)

    try:
        server_socket.bind((LOCAL_IP, PORT))
        server_socket.listen(5)
        IS_SERVER = True
        print(f"[SERVER] Running at {LOCAL_IP}:{PORT}")
    except:
        print("[SERVER] Another device is already the server.")
        server_socket = None
        IS_SERVER = False


def server_check_messages(root):
    """Accept clients + receive messages using non-blocking mode."""
    global clients, chat_history

    if IS_SERVER:
        # --------------------------
        # Accept new clients
        # --------------------------
        try:
            conn, addr = server_socket.accept()
            conn.setblocking(False)
            clients.append(conn)
            print("[SERVER] Client joined:", addr)
        except BlockingIOError:
            pass

        # --------------------------
        # Receive messages
        # --------------------------
        dead = []
        for conn in clients:
            try:
                data = conn.recv(4096)
                if data:
                    msg = pickle.loads(data)
                    chat_history.append(msg)
                    update_chat_windows(msg)

                    # broadcast to all clients
                    for c in clients:
                        if c != conn:
                            try:
                                c.sendall(pickle.dumps(msg))
                            except:
                                dead.append(c)
            except BlockingIOError:
                pass
            except:
                dead.append(conn)

        # Remove dead sockets
        for c in dead:
            if c in clients:
                clients.remove(c)

    # schedule again
    root.after(100, lambda: server_check_messages(root))
# ================================================================
# PART C — NON-BLOCKING LAN CLIENT
# ================================================================

def connect_to_server():
    """Try connecting to server (another device)."""
    global client_socket, IS_SERVER

    if IS_SERVER:
        print("[CLIENT] This device IS the server.")
        return

    client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    client_socket.setblocking(False)

    try:
        client_socket.connect((LOCAL_IP, PORT))
    except BlockingIOError:
        pass
    except:
        print("[CLIENT] No server found.")
        client_socket = None
        return

    print("[CLIENT] Connected to server!")


def client_check_messages(root):
    """Receive server messages without blocking."""
    global client_socket, chat_history

    if client_socket is not None:
        try:
            data = client_socket.recv(4096)
            if data:
                msg = pickle.loads(data)
                chat_history.append(msg)
                update_chat_windows(msg)
        except BlockingIOError:
            pass
        except:
            client_socket = None

    root.after(100, lambda: client_check_messages(root))
# ================================================================
# PART D — LOGIN + REGISTER (NO SEPARATE REGISTER WINDOW)
# ================================================================

CURRENT_USER = None
USER_DB_FILE = "users.pkl"

# Load or create user database
try:
    with open(USER_DB_FILE, "rb") as f:
        user_db = pickle.load(f)
except:
    user_db = {}  # empty database


def save_users():
    with open(USER_DB_FILE, "wb") as f:
        pickle.dump(user_db, f)


def open_login_window(root):
    login = tk.Toplevel(root)
    login.title("Login / Register")
    login.geometry("420x330")
    login.configure(bg=BG)
    login.resizable(False, False)

    tk.Label(
        login,
        text="Login / Register",
        fg="white",
        bg=BG,
        font=("Segoe UI", 26, "bold")
    ).pack(pady=15)

    # Username
    tk.Label(
        login,
        text="Username:",
        fg="white",
        bg=BG,
        font=("Segoe UI", 14)
    ).pack()
    user_entry = tk.Entry(login, font=("Segoe UI", 14))
    user_entry.pack(pady=5)

    # Password
    tk.Label(
        login,
        text="Password:",
        fg="white",
        bg=BG,
        font=("Segoe UI", 14)
    ).pack()
    pass_entry = tk.Entry(login, font=("Segoe UI", 14), show="*")
    pass_entry.pack(pady=5)

    # ----------------------------
    # LOGIN FUNCTION
    # ----------------------------
    def do_login():
        global CURRENT_USER

        username = user_entry.get().strip()
        password = pass_entry.get().strip()

        if username not in user_db:
            messagebox.showerror("Login Failed", "Account does not exist!")
            return

        if user_db[username] != password:
            messagebox.showerror("Login Failed", "Incorrect password.")
            return

        CURRENT_USER = username
        login.destroy()
        open_dashboard(root)

    # ----------------------------
    # REGISTER FUNCTION
    # ----------------------------
    def do_register():
        username = user_entry.get().strip()
        password = pass_entry.get().strip()

        if not username or not password:
            messagebox.showerror("Error", "Enter username and password.")
            return

        if username in user_db:
            messagebox.showerror("Register Failed", "Username already exists!")
            return

        # Create new account
        user_db[username] = password
        save_users()

        messagebox.showinfo("Success", "Account created! Now login.")

    # ----------------------------
    # Buttons
    # ----------------------------
    tk.Button(
        login,
        text="Login",
        bg=BTN,
        fg="white",
        activebackground=BTN_HOVER,
        width=14,
        height=2,
        command=do_login
    ).pack(pady=10)

    tk.Button(
        login,
        text="Register",
        bg=BTN,
        fg="white",
        activebackground=BTN_HOVER,
        width=14,
        height=2,
        command=do_register
    ).pack()
# ================================================================
# PART E — DASHBOARD (ALL BUTTONS RESTORED)
# ================================================================

def open_dashboard(root):
    dash = tk.Toplevel(root)
    dash.title("Dashboard")
    dash.geometry("950x550")
    dash.configure(bg=BG)
    dash.resizable(True, True)

    tk.Label(
        dash,
        text=f"Welcome, {CURRENT_USER}",
        fg="white",
        bg=BG,
        font=("Segoe UI", 28, "bold")
    ).pack(pady=25)

    container = tk.Frame(dash, bg=BG)
    container.pack()

    left = tk.Frame(container, bg=BG)
    right = tk.Frame(container, bg=BG)
    left.grid(row=0, column=0, padx=60)
    right.grid(row=0, column=1, padx=60)

    # LEFT BUTTONS
    tk.Button(left, text="Global Chat", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=lambda: open_chat_window(dash)).pack(pady=6)

    tk.Button(left, text="Open Feed", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=open_feed_window).pack(pady=6)

    tk.Button(left, text="Upload Media", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=open_upload_window).pack(pady=6)

    tk.Button(left, text="Snake Game", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=open_snake_game).pack(pady=6)

    # RIGHT BUTTONS
    tk.Button(right, text="Change Profile Picture", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=open_pfp_window).pack(pady=6)

    tk.Button(right, text="Minecraft Website", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=lambda: os.system("start https://example.com")).pack(pady=6)

    tk.Button(right, text="Credits (Made by Hadi)", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=lambda: messagebox.showinfo("Credits", "Made by Hadi ❤️")).pack(pady=6)

    tk.Button(right, text="Logout", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=lambda: (dash.destroy(), open_login_window(root))).pack(pady=6)

    tk.Button(right, text="Exit Program", width=22, height=2,
              bg=BTN, fg="white", activebackground=BTN_HOVER,
              command=root.destroy).pack(pady=6)
# ================================================================
# PART F — CHAT WINDOW (REAL-TIME, NO THREADS)
# ================================================================

open_chat_windows = []  # stores all open text widgets


def update_chat_windows(msg):
    """Update EVERY chat window instantly when new message arrives."""
    for log in open_chat_windows:
        log.config(state="normal")
        log.insert("end", f"{msg['user']}: {msg['text']}\n")
        log.config(state="disabled")
        log.see("end")


def open_chat_window(root):
    chat_win = tk.Toplevel(root)
    chat_win.title("Global Chat")
    chat_win.geometry("650x550")
    chat_win.configure(bg=BG)
    chat_win.resizable(True, True)

    tk.Label(
        chat_win,
        text="Global Chat",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=10)

    # SCROLLABLE CHAT LOG
    frame = tk.Frame(chat_win, bg=BG)
    frame.pack(fill="both", expand=True, padx=10, pady=10)

    scrollbar = tk.Scrollbar(frame)
    scrollbar.pack(side="right", fill="y")

    log = tk.Text(
        frame,
        bg="#000000",
        fg="white",
        font=("Segoe UI", 12),
        wrap="word",
        state="disabled",
        yscrollcommand=scrollbar.set
    )
    log.pack(side="left", fill="both", expand=True)
    scrollbar.config(command=log.yview)

    open_chat_windows.append(log)

    # LOAD HISTORY
    log.config(state="normal")
    for msg in chat_history:
        log.insert("end", f"{msg['user']}: {msg['text']}\n")
    log.config(state="disabled")
    log.see("end")

    entry = tk.Entry(
        chat_win,
        font=("Segoe UI", 14),
        bg="#222",
        fg="white",
        relief="flat",
        insertbackground="white"
    )
    entry.pack(fill="x", padx=10, pady=10)

    def send_msg(event=None):
        text = entry.get().strip()
        if not text:
            return

        msg = {"user": CURRENT_USER, "text": text}
        chat_history.append(msg)
        update_chat_windows(msg)

        # Client → send to server
        if client_socket:
            try: client_socket.sendall(pickle.dumps(msg))
            except: pass

        # Server → broadcast
        if IS_SERVER:
            for c in clients:
                try: c.sendall(pickle.dumps(msg))
                except: pass

        entry.delete(0, tk.END)

    entry.bind("<Return>", send_msg)

    tk.Button(
        chat_win,
        text="Send",
        bg=BTN,
        fg="white",
        width=12,
        activebackground=BTN_HOVER,
        command=send_msg
    ).pack(pady=5)
# ================================================================
# PART G — FEED VIEWER
# ================================================================

def open_feed_window():
    win = tk.Toplevel()
    win.title("Image / Video Feed")
    win.geometry("650x600")
    win.configure(bg=BG)
    win.resizable(True, True)

    tk.Label(
        win,
        text="Feed",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=10)

    frame = tk.Frame(win, bg=BG)
    frame.pack(fill="both", expand=True)

    canvas = tk.Canvas(frame, bg=BG, highlightthickness=0)
    canvas.pack(side="left", fill="both", expand=True)

    scrollbar = tk.Scrollbar(frame, command=canvas.yview)
    scrollbar.pack(side="right", fill="y")

    canvas.configure(yscrollcommand=scrollbar.set)

    inner = tk.Frame(canvas, bg=BG)
    canvas.create_window((0, 0), window=inner, anchor="nw")

    # LOAD FEED FILES
    for file in os.listdir("feed"):
        path = os.path.join("feed", file)

        tk.Label(inner, text=file, fg="white", bg=BG,
                 font=("Segoe UI", 12, "bold")).pack(pady=5)

        if file.lower().endswith((".png", ".jpg", ".jpeg", ".gif")):
            img = Image.open(path)
            img.thumbnail((400, 400))
            photo = ImageTk.PhotoImage(img)

            lbl = tk.Label(inner, image=photo, bg=BG)
            lbl.image = photo
            lbl.pack(pady=10)

        elif file.lower().endswith((".mp4", ".mov", ".avi")):
            tk.Label(inner, text="[Video File]", fg="cyan", bg=BG).pack(pady=10)

    inner.update_idletasks()
    canvas.configure(scrollregion=canvas.bbox("all"))
# ================================================================
# PART H — UPLOAD MEDIA (Feed Upload)
# ================================================================

def open_upload_window():
    win = tk.Toplevel()
    win.title("Upload Media")
    win.geometry("400x250")
    win.configure(bg=BG)
    win.resizable(False, False)

    tk.Label(
        win,
        text="Upload Image / Video",
        fg="white",
        bg=BG,
        font=("Segoe UI", 20, "bold")
    ).pack(pady=20)

    def do_upload():
        file = filedialog.askopenfilename(
            filetypes=[
                ("Media Files", "*.jpg;*.png;*.jpeg;*.gif;*.mp4;*.mov;*.avi"),
                ("All Files", "*.*")
            ]
        )
        if not file:
            return

        # copy file into "feed/" folder
        filename = os.path.basename(file)
        dest = os.path.join("feed", filename)

        with open(file, "rb") as src:
            with open(dest, "wb") as dst:
                dst.write(src.read())

        messagebox.showinfo("Success", "Media uploaded!")
        win.destroy()

    tk.Button(
        win,
        text="Select File",
        bg=BTN,
        fg="white",
        width=18,
        height=2,
        activebackground=BTN_HOVER,
        command=do_upload
    ).pack(pady=30)
# ================================================================
# PART I — CHANGE PROFILE PICTURE
# ================================================================

def open_pfp_window():
    win = tk.Toplevel()
    win.title("Change Profile Picture")
    win.geometry("400x260")
    win.configure(bg=BG)
    win.resizable(False, False)

    tk.Label(
        win,
        text="Change Profile Picture",
        fg="white",
        bg=BG,
        font=("Segoe UI", 20, "bold")
    ).pack(pady=20)

    def choose_pfp():
        file = filedialog.askopenfilename(
            filetypes=[
                ("Image Files", "*.jpg;*.png;*.jpeg;*.gif"),
                ("All Files", "*.*")
            ]
        )
        if not file:
            return

        dest_path = os.path.join("pfp", f"{CURRENT_USER}.png")

        # Save image as PNG
        img = Image.open(file)
        img.save(dest_path)

        messagebox.showinfo("Success", "Profile picture updated!")
        win.destroy()

    tk.Button(
        win,
        text="Choose File",
        width=18,
        height=2,
        bg=BTN,
        fg="white",
        activebackground=BTN_HOVER,
        command=choose_pfp
    ).pack(pady=30)
# ================================================================
# PART J — SNAKE GAME
# ================================================================

def open_snake_game():
    game = tk.Toplevel()
    game.title("Snake Game")
    game.geometry("520x560")
    game.configure(bg=BG)
    game.resizable(False, False)

    W, H = 500, 500
    SIZE = 20

    tk.Label(
        game,
        text="Snake Game",
        fg="white",
        bg=BG,
        font=("Segoe UI", 22, "bold")
    ).pack(pady=10)

    canvas = tk.Canvas(game, width=W, height=H, bg="black", highlightthickness=0)
    canvas.pack()

    snake = [(100, 100), (80, 100), (60, 100)]
    direction = "RIGHT"

    import random

    def spawn_food():
        return (
            random.randint(0, (W // SIZE) - 1) * SIZE,
            random.randint(0, (H // SIZE) - 1) * SIZE
        )

    food = spawn_food()
    score = 0

    def draw():
        canvas.delete("all")
        for x, y in snake:
            canvas.create_rectangle(x, y, x + SIZE, y + SIZE, fill="lime")
        fx, fy = food
        canvas.create_oval(fx, fy, fx + SIZE, fy + SIZE, fill="red")
        canvas.create_text(10, 10, anchor="nw", fill="white",
                           font=("Segoe UI", 14), text=f"Score: {score}")

    def tick():
        nonlocal food, score, direction

        x, y = snake[0]
        if direction == "UP": y -= SIZE
        elif direction == "DOWN": y += SIZE
        elif direction == "LEFT": x -= SIZE
        elif direction == "RIGHT": x += SIZE

        new_head = (x, y)

        # Wall / Self collision
        if x < 0 or x >= W or y < 0 or y >= H or new_head in snake:
            messagebox.showinfo("Game Over", f"Final Score: {score}")
            game.destroy()
            return

        snake.insert(0, new_head)

        # Food collision
        if new_head == food:
            score += 1
            food = spawn_food()
        else:
            snake.pop()

        draw()
        game.after(100, tick)

    def key(event):
        nonlocal direction
        k = event.keysym.upper()
        if k in ("W", "UP") and direction != "DOWN":
            direction = "UP"
        elif k in ("S", "DOWN") and direction != "UP":
            direction = "DOWN"
        elif k in ("A", "LEFT") and direction != "RIGHT":
            direction = "LEFT"
        elif k in ("D", "RIGHT") and direction != "LEFT":
            direction = "RIGHT"

    game.bind("<Key>", key)
    draw()
    tick()
# ================================================================
# PART K — STARTUP SEQUENCE
# ================================================================

def main_startup():
    root = tk.Tk()
    root.withdraw()  # Hide base window

    # Start server if possible
    start_server()

    # Connect as client if not server
    connect_to_server()

    # Start non-blocking loops
    server_check_messages(root)
    client_check_messages(root)

    # Open Login Screen
    open_login_window(root)

    root.mainloop()


if __name__ == "__main__":
    main_startup()</p>
    </div>
  </div>
</div>

<!-- POPUP -->
<div id="popupNote">If you want to buy this product, contact us on Discord: Mazm3n</div>

<script>
// INTRO
window.addEventListener("DOMContentLoaded",()=>{
  const intro=document.getElementById("intro");

  setTimeout(()=>{
    intro.style.opacity="0";
    setTimeout(()=>intro.style.display="none",1000);
    setTimeout(()=>startHeadline(),1100);
  },3000);
});

// HEADLINE & COUNT
function startHeadline(){
  const headline=document.getElementById("headline");

  const texts=[
    "1600+ Cheap Robux in stock",
    "Wanna buy? Contact us in Discord/Snapchat",
    "100% Trusted Market",
    "Make sure to feed back to help us improve"
  ];

  let index=0;

  function countUp(){
    let num=0;
    const target=1600;
    const duration=3000;
    const steps=60;
    const inc=target/steps;

    const interval=setInterval(()=>{
      num+=inc;
      if(num>=1600){
        num=1600;
        clearInterval(interval);
      }
      headline.textContent=Math.floor(num) + "+ Cheap Robux in stock";
    },duration/steps);
  }

  countUp();

  setInterval(()=>{
    headline.style.opacity="0";

    setTimeout(()=>{
      index=(index+1)%texts.length;
      headline.textContent=texts[index];
      if(index===0) countUp();
      headline.style.opacity="1";
    },600);

  },5000);
}

// SECTION OPEN
function openSection(section){
  document.body.style.overflow="hidden";

  const home=document.getElementById("home");
  home.style.opacity="0";
  home.style.pointerEvents="none";

  const sec=document.getElementById(section+"Section");
  setTimeout(()=>{
    sec.classList.add("active");
    if(section==='shop') animateShop();
  },400);
}

// TERMINAL OPEN
function openTerminal(){
  window.location.href="Terminal.html";
}

// BACK HOME
function goHome(){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));

  const home=document.getElementById("home");
  home.style.opacity="1";
  home.style.pointerEvents="auto";
}

// SHOP ANIMATION
function animateShop(){
  const shop=document.getElementById('shopSection');
  const cats=shop.querySelectorAll('.category-title');
  const cards=shop.querySelectorAll('.product-card');

  cats.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*200));
  cards.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*200+300));

  cards.forEach(card=>card.onclick=()=>showPopup());
}

// POPUP
function showPopup(){
  const popup=document.getElementById('popupNote');
  popup.classList.add('show');
  setTimeout(()=>popup.classList.remove('show'),4000);
}

// GAME REDIRECTS
function redirectGame(game){
  if(game==='minecraft') window.location.href="https://avacaine.github.io/";
  if(game==='1v1') window.location.href="https://funblocked.s3.amazonaws.com/1v1.html";
}
</script>
</body>
</html>



<script type="text/javascript">window.$crisp=[];window.CRISP_WEBSITE_ID="49cbe588-16a0-40ad-b50b-844419c11121";(function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();</script>

